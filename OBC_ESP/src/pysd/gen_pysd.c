#include <string.h>
#include "pysd/gen_pysd.h"

/**
 * @brief Get header size
 *
 * @param new_line_ending end string with new line character
 * @return size_t header size
 */
size_t pysd_get_header_size(bool new_line_ending) {
    size_t string_size;
    if (new_line_ending == true) {
        string_size = snprintf(NULL, 0, "mcb state;mcb uptime;mcb mission_timer;mcb disconnect_remaining_time;mcb connection_status;mcb batteryVoltage;mcb temp_mcp;mcb temp_lp25;mcb pressure;mcb altitude;mcb velocity;mcb watchdogResets;mcb ignition;mcb apogee;mcb imu ax;mcb imu ay;mcb imu az;mcb imu gx;mcb imu gy;mcb imu gz;mcb imu mx;mcb imu my;mcb imu mz;mcb imu temperature;mcb imu pressure;mcb imu altitude;mcb gps latitude;mcb gps longitude;mcb gps gps_altitude;mcb gps satellites;mcb gps is_time_valid;pitot wakenUp;pitot vBat;pitot statPress;pitot dynamicPress;pitot temp;pitot altitude;pitot speed;pitot estimated_apogee;mainValve wakeUp;mainValve valveState;mainValve thermocoupleOne;mainValve thermocoupleTwo;mainValve batteryVoltage;tanWa tanWaState;tanWa ground_pressure;tanWa tankHeating;tanWa abortButton;tanWa armButton;tanWa igniterContinouityOne;tanWa igniterContinouityTwo;tanWa vbat;tanWa motor_one;tanWa motor_two;tanWa motor_three;tanWa motor_four;tanWa motor_five;tanWa rocketWeight;tanWa tankWeight;tanWa rocketWeightRaw;tanWa tankWeightRaw;tanWa thermocouple_one;tanWa thermocouple_two;tanWa thermocouple_three;upustValve wakeUp;upustValve valveState;upustValve thermistor;upustValve tankPressure;upustValve batteryVoltage;recovery isArmed;recovery firstStageContinouity;recovery secondStageContinouity;recovery separationSwitch1;recovery separationSwitch2;recovery telemetrumFirstStage;recovery telemetrumSecondStage;recovery altimaxFirstStage;recovery altimaxSecondStage;recovery apogemixFirstStage;recovery apogemixSecondStage;recovery firstStageDone;recovery secondStageDone;recovery isTeleActive;blackBox wakeUp;blackBox batteryVoltage;payload wakenUp;payload isRecording;payload data;payload vBat;payload isRpiOn;options lora_freq_khz;options countdown_begin_time;options ignition_time;options tank_min_pressure;options flash_write;options force_launch;options data_current_period;options lora_current_period;options flash_write_current_period;options sd_write_current_period;errors sd;errors flash;errors rtos;errors espnow;errors watchdog;errors sensors;errors exceptions;errors recovery;\n");
    } else {
        string_size = snprintf(NULL, 0, "mcb state;mcb uptime;mcb mission_timer;mcb disconnect_remaining_time;mcb connection_status;mcb batteryVoltage;mcb temp_mcp;mcb temp_lp25;mcb pressure;mcb altitude;mcb velocity;mcb watchdogResets;mcb ignition;mcb apogee;mcb imu ax;mcb imu ay;mcb imu az;mcb imu gx;mcb imu gy;mcb imu gz;mcb imu mx;mcb imu my;mcb imu mz;mcb imu temperature;mcb imu pressure;mcb imu altitude;mcb gps latitude;mcb gps longitude;mcb gps gps_altitude;mcb gps satellites;mcb gps is_time_valid;pitot wakenUp;pitot vBat;pitot statPress;pitot dynamicPress;pitot temp;pitot altitude;pitot speed;pitot estimated_apogee;mainValve wakeUp;mainValve valveState;mainValve thermocoupleOne;mainValve thermocoupleTwo;mainValve batteryVoltage;tanWa tanWaState;tanWa ground_pressure;tanWa tankHeating;tanWa abortButton;tanWa armButton;tanWa igniterContinouityOne;tanWa igniterContinouityTwo;tanWa vbat;tanWa motor_one;tanWa motor_two;tanWa motor_three;tanWa motor_four;tanWa motor_five;tanWa rocketWeight;tanWa tankWeight;tanWa rocketWeightRaw;tanWa tankWeightRaw;tanWa thermocouple_one;tanWa thermocouple_two;tanWa thermocouple_three;upustValve wakeUp;upustValve valveState;upustValve thermistor;upustValve tankPressure;upustValve batteryVoltage;recovery isArmed;recovery firstStageContinouity;recovery secondStageContinouity;recovery separationSwitch1;recovery separationSwitch2;recovery telemetrumFirstStage;recovery telemetrumSecondStage;recovery altimaxFirstStage;recovery altimaxSecondStage;recovery apogemixFirstStage;recovery apogemixSecondStage;recovery firstStageDone;recovery secondStageDone;recovery isTeleActive;blackBox wakeUp;blackBox batteryVoltage;payload wakenUp;payload isRecording;payload data;payload vBat;payload isRpiOn;options lora_freq_khz;options countdown_begin_time;options ignition_time;options tank_min_pressure;options flash_write;options force_launch;options data_current_period;options lora_current_period;options flash_write_current_period;options sd_write_current_period;errors sd;errors flash;errors rtos;errors espnow;errors watchdog;errors sensors;errors exceptions;errors recovery;");
    }

    return string_size;
}

/**
 * @brief Get size of sd data frame
 *
 * @param pysd_main
 * @param new_line_ending end string with new line character
 * @return size_t frame size
 */
size_t pysd_get_sd_frame_size(pysdmain_DataFrame pysd_main, bool new_line_ending) {
    size_t string_size;
    if (new_line_ending == true) {
        string_size = snprintf(NULL, 0, "%d;%lu;%d;%lu;%d;%f;%f;%f;%f;%f;%f;%d;%d;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%d;%d;%f;%f;%lu;%lu;%f;%f;%f;%d;%d;%d;%f;%f;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%f;%d;%lu;%d;%d;%d;%d;%d;%lu;%lu;%lu;%lu;%d;%d;%d;%d;%d;%d;%d;%d;\n", pysd_main.mcb.state, pysd_main.mcb.uptime, pysd_main.mcb.mission_timer, pysd_main.mcb.disconnect_remaining_time, pysd_main.mcb.connection_status, pysd_main.mcb.batteryVoltage, pysd_main.mcb.temp_mcp, pysd_main.mcb.temp_lp25, pysd_main.mcb.pressure, pysd_main.mcb.altitude, pysd_main.mcb.velocity, pysd_main.mcb.watchdogResets, pysd_main.mcb.ignition, pysd_main.mcb.apogee, pysd_main.mcb.imu.ax, pysd_main.mcb.imu.ay, pysd_main.mcb.imu.az, pysd_main.mcb.imu.gx, pysd_main.mcb.imu.gy, pysd_main.mcb.imu.gz, pysd_main.mcb.imu.mx, pysd_main.mcb.imu.my, pysd_main.mcb.imu.mz, pysd_main.mcb.imu.temperature, pysd_main.mcb.imu.pressure, pysd_main.mcb.imu.altitude, pysd_main.mcb.gps.latitude, pysd_main.mcb.gps.longitude, pysd_main.mcb.gps.gps_altitude, pysd_main.mcb.gps.satellites, pysd_main.mcb.gps.is_time_valid, pysd_main.pitot.wakenUp, pysd_main.pitot.vBat, pysd_main.pitot.statPress, pysd_main.pitot.dynamicPress, pysd_main.pitot.temp, pysd_main.pitot.altitude, pysd_main.pitot.speed, pysd_main.pitot.estimated_apogee, pysd_main.mainValve.wakeUp, pysd_main.mainValve.valveState, pysd_main.mainValve.thermocoupleOne, pysd_main.mainValve.thermocoupleTwo, pysd_main.mainValve.batteryVoltage, pysd_main.tanWa.tanWaState, pysd_main.tanWa.ground_pressure, pysd_main.tanWa.tankHeating, pysd_main.tanWa.abortButton, pysd_main.tanWa.armButton, pysd_main.tanWa.igniterContinouityOne, pysd_main.tanWa.igniterContinouityTwo, pysd_main.tanWa.vbat, pysd_main.tanWa.motor_one, pysd_main.tanWa.motor_two, pysd_main.tanWa.motor_three, pysd_main.tanWa.motor_four, pysd_main.tanWa.motor_five, pysd_main.tanWa.rocketWeight, pysd_main.tanWa.tankWeight, pysd_main.tanWa.rocketWeightRaw, pysd_main.tanWa.tankWeightRaw, pysd_main.tanWa.thermocouple_one, pysd_main.tanWa.thermocouple_two, pysd_main.tanWa.thermocouple_three, pysd_main.upustValve.wakeUp, pysd_main.upustValve.valveState, pysd_main.upustValve.thermistor, pysd_main.upustValve.tankPressure, pysd_main.upustValve.batteryVoltage, pysd_main.recovery.isArmed, pysd_main.recovery.firstStageContinouity, pysd_main.recovery.secondStageContinouity, pysd_main.recovery.separationSwitch1, pysd_main.recovery.separationSwitch2, pysd_main.recovery.telemetrumFirstStage, pysd_main.recovery.telemetrumSecondStage, pysd_main.recovery.altimaxFirstStage, pysd_main.recovery.altimaxSecondStage, pysd_main.recovery.apogemixFirstStage, pysd_main.recovery.apogemixSecondStage, pysd_main.recovery.firstStageDone, pysd_main.recovery.secondStageDone, pysd_main.recovery.isTeleActive, pysd_main.blackBox.wakeUp, pysd_main.blackBox.batteryVoltage, pysd_main.payload.wakenUp, pysd_main.payload.isRecording, pysd_main.payload.data, pysd_main.payload.vBat, pysd_main.payload.isRpiOn, pysd_main.options.lora_freq_khz, pysd_main.options.countdown_begin_time, pysd_main.options.ignition_time, pysd_main.options.tank_min_pressure, pysd_main.options.flash_write, pysd_main.options.force_launch, pysd_main.options.data_current_period, pysd_main.options.lora_current_period, pysd_main.options.flash_write_current_period, pysd_main.options.sd_write_current_period, pysd_main.errors.sd, pysd_main.errors.flash, pysd_main.errors.rtos, pysd_main.errors.espnow, pysd_main.errors.watchdog, pysd_main.errors.sensors, pysd_main.errors.exceptions, pysd_main.errors.recovery);
    } else {
        string_size = snprintf(NULL, 0, "%d;%lu;%d;%lu;%d;%f;%f;%f;%f;%f;%f;%d;%d;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%d;%d;%f;%f;%lu;%lu;%f;%f;%f;%d;%d;%d;%f;%f;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%f;%d;%lu;%d;%d;%d;%d;%d;%lu;%lu;%lu;%lu;%d;%d;%d;%d;%d;%d;%d;%d;", pysd_main.mcb.state, pysd_main.mcb.uptime, pysd_main.mcb.mission_timer, pysd_main.mcb.disconnect_remaining_time, pysd_main.mcb.connection_status, pysd_main.mcb.batteryVoltage, pysd_main.mcb.temp_mcp, pysd_main.mcb.temp_lp25, pysd_main.mcb.pressure, pysd_main.mcb.altitude, pysd_main.mcb.velocity, pysd_main.mcb.watchdogResets, pysd_main.mcb.ignition, pysd_main.mcb.apogee, pysd_main.mcb.imu.ax, pysd_main.mcb.imu.ay, pysd_main.mcb.imu.az, pysd_main.mcb.imu.gx, pysd_main.mcb.imu.gy, pysd_main.mcb.imu.gz, pysd_main.mcb.imu.mx, pysd_main.mcb.imu.my, pysd_main.mcb.imu.mz, pysd_main.mcb.imu.temperature, pysd_main.mcb.imu.pressure, pysd_main.mcb.imu.altitude, pysd_main.mcb.gps.latitude, pysd_main.mcb.gps.longitude, pysd_main.mcb.gps.gps_altitude, pysd_main.mcb.gps.satellites, pysd_main.mcb.gps.is_time_valid, pysd_main.pitot.wakenUp, pysd_main.pitot.vBat, pysd_main.pitot.statPress, pysd_main.pitot.dynamicPress, pysd_main.pitot.temp, pysd_main.pitot.altitude, pysd_main.pitot.speed, pysd_main.pitot.estimated_apogee, pysd_main.mainValve.wakeUp, pysd_main.mainValve.valveState, pysd_main.mainValve.thermocoupleOne, pysd_main.mainValve.thermocoupleTwo, pysd_main.mainValve.batteryVoltage, pysd_main.tanWa.tanWaState, pysd_main.tanWa.ground_pressure, pysd_main.tanWa.tankHeating, pysd_main.tanWa.abortButton, pysd_main.tanWa.armButton, pysd_main.tanWa.igniterContinouityOne, pysd_main.tanWa.igniterContinouityTwo, pysd_main.tanWa.vbat, pysd_main.tanWa.motor_one, pysd_main.tanWa.motor_two, pysd_main.tanWa.motor_three, pysd_main.tanWa.motor_four, pysd_main.tanWa.motor_five, pysd_main.tanWa.rocketWeight, pysd_main.tanWa.tankWeight, pysd_main.tanWa.rocketWeightRaw, pysd_main.tanWa.tankWeightRaw, pysd_main.tanWa.thermocouple_one, pysd_main.tanWa.thermocouple_two, pysd_main.tanWa.thermocouple_three, pysd_main.upustValve.wakeUp, pysd_main.upustValve.valveState, pysd_main.upustValve.thermistor, pysd_main.upustValve.tankPressure, pysd_main.upustValve.batteryVoltage, pysd_main.recovery.isArmed, pysd_main.recovery.firstStageContinouity, pysd_main.recovery.secondStageContinouity, pysd_main.recovery.separationSwitch1, pysd_main.recovery.separationSwitch2, pysd_main.recovery.telemetrumFirstStage, pysd_main.recovery.telemetrumSecondStage, pysd_main.recovery.altimaxFirstStage, pysd_main.recovery.altimaxSecondStage, pysd_main.recovery.apogemixFirstStage, pysd_main.recovery.apogemixSecondStage, pysd_main.recovery.firstStageDone, pysd_main.recovery.secondStageDone, pysd_main.recovery.isTeleActive, pysd_main.blackBox.wakeUp, pysd_main.blackBox.batteryVoltage, pysd_main.payload.wakenUp, pysd_main.payload.isRecording, pysd_main.payload.data, pysd_main.payload.vBat, pysd_main.payload.isRpiOn, pysd_main.options.lora_freq_khz, pysd_main.options.countdown_begin_time, pysd_main.options.ignition_time, pysd_main.options.tank_min_pressure, pysd_main.options.flash_write, pysd_main.options.force_launch, pysd_main.options.data_current_period, pysd_main.options.lora_current_period, pysd_main.options.flash_write_current_period, pysd_main.options.sd_write_current_period, pysd_main.errors.sd, pysd_main.errors.flash, pysd_main.errors.rtos, pysd_main.errors.espnow, pysd_main.errors.watchdog, pysd_main.errors.sensors, pysd_main.errors.exceptions, pysd_main.errors.recovery);
    }

    return string_size;
}

/**
 * @brief Fill buffer with struct variables names
 * 
 * @param buffer pointer to buffer
 * @param size buffer size
 * @param pysdmain_DataFrame struct with data
 * @param new_line_ending end string with new line character
 * @return size_t size of wrote data, return 0 in case of failure
 */
size_t pysd_create_header(char *buffer, size_t size, bool new_line_ending) {
    size_t header_size;
    header_size = pysd_get_header_size(new_line_ending);

    if (header_size > size) {
        return false;
    }

    if (new_line_ending == true) {
        snprintf(buffer, size, "mcb state;mcb uptime;mcb mission_timer;mcb disconnect_remaining_time;mcb connection_status;mcb batteryVoltage;mcb temp_mcp;mcb temp_lp25;mcb pressure;mcb altitude;mcb velocity;mcb watchdogResets;mcb ignition;mcb apogee;mcb imu ax;mcb imu ay;mcb imu az;mcb imu gx;mcb imu gy;mcb imu gz;mcb imu mx;mcb imu my;mcb imu mz;mcb imu temperature;mcb imu pressure;mcb imu altitude;mcb gps latitude;mcb gps longitude;mcb gps gps_altitude;mcb gps satellites;mcb gps is_time_valid;pitot wakenUp;pitot vBat;pitot statPress;pitot dynamicPress;pitot temp;pitot altitude;pitot speed;pitot estimated_apogee;mainValve wakeUp;mainValve valveState;mainValve thermocoupleOne;mainValve thermocoupleTwo;mainValve batteryVoltage;tanWa tanWaState;tanWa ground_pressure;tanWa tankHeating;tanWa abortButton;tanWa armButton;tanWa igniterContinouityOne;tanWa igniterContinouityTwo;tanWa vbat;tanWa motor_one;tanWa motor_two;tanWa motor_three;tanWa motor_four;tanWa motor_five;tanWa rocketWeight;tanWa tankWeight;tanWa rocketWeightRaw;tanWa tankWeightRaw;tanWa thermocouple_one;tanWa thermocouple_two;tanWa thermocouple_three;upustValve wakeUp;upustValve valveState;upustValve thermistor;upustValve tankPressure;upustValve batteryVoltage;recovery isArmed;recovery firstStageContinouity;recovery secondStageContinouity;recovery separationSwitch1;recovery separationSwitch2;recovery telemetrumFirstStage;recovery telemetrumSecondStage;recovery altimaxFirstStage;recovery altimaxSecondStage;recovery apogemixFirstStage;recovery apogemixSecondStage;recovery firstStageDone;recovery secondStageDone;recovery isTeleActive;blackBox wakeUp;blackBox batteryVoltage;payload wakenUp;payload isRecording;payload data;payload vBat;payload isRpiOn;options lora_freq_khz;options countdown_begin_time;options ignition_time;options tank_min_pressure;options flash_write;options force_launch;options data_current_period;options lora_current_period;options flash_write_current_period;options sd_write_current_period;errors sd;errors flash;errors rtos;errors espnow;errors watchdog;errors sensors;errors exceptions;errors recovery;\n");
    } else {
        snprintf(buffer, size, "mcb state;mcb uptime;mcb mission_timer;mcb disconnect_remaining_time;mcb connection_status;mcb batteryVoltage;mcb temp_mcp;mcb temp_lp25;mcb pressure;mcb altitude;mcb velocity;mcb watchdogResets;mcb ignition;mcb apogee;mcb imu ax;mcb imu ay;mcb imu az;mcb imu gx;mcb imu gy;mcb imu gz;mcb imu mx;mcb imu my;mcb imu mz;mcb imu temperature;mcb imu pressure;mcb imu altitude;mcb gps latitude;mcb gps longitude;mcb gps gps_altitude;mcb gps satellites;mcb gps is_time_valid;pitot wakenUp;pitot vBat;pitot statPress;pitot dynamicPress;pitot temp;pitot altitude;pitot speed;pitot estimated_apogee;mainValve wakeUp;mainValve valveState;mainValve thermocoupleOne;mainValve thermocoupleTwo;mainValve batteryVoltage;tanWa tanWaState;tanWa ground_pressure;tanWa tankHeating;tanWa abortButton;tanWa armButton;tanWa igniterContinouityOne;tanWa igniterContinouityTwo;tanWa vbat;tanWa motor_one;tanWa motor_two;tanWa motor_three;tanWa motor_four;tanWa motor_five;tanWa rocketWeight;tanWa tankWeight;tanWa rocketWeightRaw;tanWa tankWeightRaw;tanWa thermocouple_one;tanWa thermocouple_two;tanWa thermocouple_three;upustValve wakeUp;upustValve valveState;upustValve thermistor;upustValve tankPressure;upustValve batteryVoltage;recovery isArmed;recovery firstStageContinouity;recovery secondStageContinouity;recovery separationSwitch1;recovery separationSwitch2;recovery telemetrumFirstStage;recovery telemetrumSecondStage;recovery altimaxFirstStage;recovery altimaxSecondStage;recovery apogemixFirstStage;recovery apogemixSecondStage;recovery firstStageDone;recovery secondStageDone;recovery isTeleActive;blackBox wakeUp;blackBox batteryVoltage;payload wakenUp;payload isRecording;payload data;payload vBat;payload isRpiOn;options lora_freq_khz;options countdown_begin_time;options ignition_time;options tank_min_pressure;options flash_write;options force_launch;options data_current_period;options lora_current_period;options flash_write_current_period;options sd_write_current_period;errors sd;errors flash;errors rtos;errors espnow;errors watchdog;errors sensors;errors exceptions;errors recovery;");
    }

    return header_size;
}

/**
 * @brief Fill buffer with struct data
 *
 * @param buffer pointer to buffer
 * @param size buffer size
 * @param ...pysd_main... struct with data
 * @param new_line_ending end string with new line character
 * @return size_t size of wrote data, return 0 in case of failure
 */
size_t pysd_create_sd_frame(char *buffer, size_t size, pysdmain_DataFrame pysd_main, bool new_line_ending) {
    size_t frame_size;
    frame_size = pysd_get_sd_frame_size(pysd_main, new_line_ending);

    if (frame_size > size) {
        return 0;
    }

    if (new_line_ending == true) {
        snprintf(buffer, size, "%d;%lu;%d;%lu;%d;%f;%f;%f;%f;%f;%f;%d;%d;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%d;%d;%f;%f;%lu;%lu;%f;%f;%f;%d;%d;%d;%f;%f;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%f;%d;%lu;%d;%d;%d;%d;%d;%lu;%lu;%lu;%lu;%d;%d;%d;%d;%d;%d;%d;%d;\n", pysd_main.mcb.state, pysd_main.mcb.uptime, pysd_main.mcb.mission_timer, pysd_main.mcb.disconnect_remaining_time, pysd_main.mcb.connection_status, pysd_main.mcb.batteryVoltage, pysd_main.mcb.temp_mcp, pysd_main.mcb.temp_lp25, pysd_main.mcb.pressure, pysd_main.mcb.altitude, pysd_main.mcb.velocity, pysd_main.mcb.watchdogResets, pysd_main.mcb.ignition, pysd_main.mcb.apogee, pysd_main.mcb.imu.ax, pysd_main.mcb.imu.ay, pysd_main.mcb.imu.az, pysd_main.mcb.imu.gx, pysd_main.mcb.imu.gy, pysd_main.mcb.imu.gz, pysd_main.mcb.imu.mx, pysd_main.mcb.imu.my, pysd_main.mcb.imu.mz, pysd_main.mcb.imu.temperature, pysd_main.mcb.imu.pressure, pysd_main.mcb.imu.altitude, pysd_main.mcb.gps.latitude, pysd_main.mcb.gps.longitude, pysd_main.mcb.gps.gps_altitude, pysd_main.mcb.gps.satellites, pysd_main.mcb.gps.is_time_valid, pysd_main.pitot.wakenUp, pysd_main.pitot.vBat, pysd_main.pitot.statPress, pysd_main.pitot.dynamicPress, pysd_main.pitot.temp, pysd_main.pitot.altitude, pysd_main.pitot.speed, pysd_main.pitot.estimated_apogee, pysd_main.mainValve.wakeUp, pysd_main.mainValve.valveState, pysd_main.mainValve.thermocoupleOne, pysd_main.mainValve.thermocoupleTwo, pysd_main.mainValve.batteryVoltage, pysd_main.tanWa.tanWaState, pysd_main.tanWa.ground_pressure, pysd_main.tanWa.tankHeating, pysd_main.tanWa.abortButton, pysd_main.tanWa.armButton, pysd_main.tanWa.igniterContinouityOne, pysd_main.tanWa.igniterContinouityTwo, pysd_main.tanWa.vbat, pysd_main.tanWa.motor_one, pysd_main.tanWa.motor_two, pysd_main.tanWa.motor_three, pysd_main.tanWa.motor_four, pysd_main.tanWa.motor_five, pysd_main.tanWa.rocketWeight, pysd_main.tanWa.tankWeight, pysd_main.tanWa.rocketWeightRaw, pysd_main.tanWa.tankWeightRaw, pysd_main.tanWa.thermocouple_one, pysd_main.tanWa.thermocouple_two, pysd_main.tanWa.thermocouple_three, pysd_main.upustValve.wakeUp, pysd_main.upustValve.valveState, pysd_main.upustValve.thermistor, pysd_main.upustValve.tankPressure, pysd_main.upustValve.batteryVoltage, pysd_main.recovery.isArmed, pysd_main.recovery.firstStageContinouity, pysd_main.recovery.secondStageContinouity, pysd_main.recovery.separationSwitch1, pysd_main.recovery.separationSwitch2, pysd_main.recovery.telemetrumFirstStage, pysd_main.recovery.telemetrumSecondStage, pysd_main.recovery.altimaxFirstStage, pysd_main.recovery.altimaxSecondStage, pysd_main.recovery.apogemixFirstStage, pysd_main.recovery.apogemixSecondStage, pysd_main.recovery.firstStageDone, pysd_main.recovery.secondStageDone, pysd_main.recovery.isTeleActive, pysd_main.blackBox.wakeUp, pysd_main.blackBox.batteryVoltage, pysd_main.payload.wakenUp, pysd_main.payload.isRecording, pysd_main.payload.data, pysd_main.payload.vBat, pysd_main.payload.isRpiOn, pysd_main.options.lora_freq_khz, pysd_main.options.countdown_begin_time, pysd_main.options.ignition_time, pysd_main.options.tank_min_pressure, pysd_main.options.flash_write, pysd_main.options.force_launch, pysd_main.options.data_current_period, pysd_main.options.lora_current_period, pysd_main.options.flash_write_current_period, pysd_main.options.sd_write_current_period, pysd_main.errors.sd, pysd_main.errors.flash, pysd_main.errors.rtos, pysd_main.errors.espnow, pysd_main.errors.watchdog, pysd_main.errors.sensors, pysd_main.errors.exceptions, pysd_main.errors.recovery);
    } else {
        snprintf(buffer, size, "%d;%lu;%d;%lu;%d;%f;%f;%f;%f;%f;%f;%d;%d;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%f;%f;%f;%d;%d;%d;%f;%f;%f;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%d;%d;%f;%f;%lu;%lu;%f;%f;%f;%d;%d;%d;%f;%f;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%d;%f;%d;%d;%d;%f;%d;%lu;%d;%d;%d;%d;%d;%lu;%lu;%lu;%lu;%d;%d;%d;%d;%d;%d;%d;%d;\n", pysd_main.mcb.state, pysd_main.mcb.uptime, pysd_main.mcb.mission_timer, pysd_main.mcb.disconnect_remaining_time, pysd_main.mcb.connection_status, pysd_main.mcb.batteryVoltage, pysd_main.mcb.temp_mcp, pysd_main.mcb.temp_lp25, pysd_main.mcb.pressure, pysd_main.mcb.altitude, pysd_main.mcb.velocity, pysd_main.mcb.watchdogResets, pysd_main.mcb.ignition, pysd_main.mcb.apogee, pysd_main.mcb.imu.ax, pysd_main.mcb.imu.ay, pysd_main.mcb.imu.az, pysd_main.mcb.imu.gx, pysd_main.mcb.imu.gy, pysd_main.mcb.imu.gz, pysd_main.mcb.imu.mx, pysd_main.mcb.imu.my, pysd_main.mcb.imu.mz, pysd_main.mcb.imu.temperature, pysd_main.mcb.imu.pressure, pysd_main.mcb.imu.altitude, pysd_main.mcb.gps.latitude, pysd_main.mcb.gps.longitude, pysd_main.mcb.gps.gps_altitude, pysd_main.mcb.gps.satellites, pysd_main.mcb.gps.is_time_valid, pysd_main.pitot.wakenUp, pysd_main.pitot.vBat, pysd_main.pitot.statPress, pysd_main.pitot.dynamicPress, pysd_main.pitot.temp, pysd_main.pitot.altitude, pysd_main.pitot.speed, pysd_main.pitot.estimated_apogee, pysd_main.mainValve.wakeUp, pysd_main.mainValve.valveState, pysd_main.mainValve.thermocoupleOne, pysd_main.mainValve.thermocoupleTwo, pysd_main.mainValve.batteryVoltage, pysd_main.tanWa.tanWaState, pysd_main.tanWa.ground_pressure, pysd_main.tanWa.tankHeating, pysd_main.tanWa.abortButton, pysd_main.tanWa.armButton, pysd_main.tanWa.igniterContinouityOne, pysd_main.tanWa.igniterContinouityTwo, pysd_main.tanWa.vbat, pysd_main.tanWa.motor_one, pysd_main.tanWa.motor_two, pysd_main.tanWa.motor_three, pysd_main.tanWa.motor_four, pysd_main.tanWa.motor_five, pysd_main.tanWa.rocketWeight, pysd_main.tanWa.tankWeight, pysd_main.tanWa.rocketWeightRaw, pysd_main.tanWa.tankWeightRaw, pysd_main.tanWa.thermocouple_one, pysd_main.tanWa.thermocouple_two, pysd_main.tanWa.thermocouple_three, pysd_main.upustValve.wakeUp, pysd_main.upustValve.valveState, pysd_main.upustValve.thermistor, pysd_main.upustValve.tankPressure, pysd_main.upustValve.batteryVoltage, pysd_main.recovery.isArmed, pysd_main.recovery.firstStageContinouity, pysd_main.recovery.secondStageContinouity, pysd_main.recovery.separationSwitch1, pysd_main.recovery.separationSwitch2, pysd_main.recovery.telemetrumFirstStage, pysd_main.recovery.telemetrumSecondStage, pysd_main.recovery.altimaxFirstStage, pysd_main.recovery.altimaxSecondStage, pysd_main.recovery.apogemixFirstStage, pysd_main.recovery.apogemixSecondStage, pysd_main.recovery.firstStageDone, pysd_main.recovery.secondStageDone, pysd_main.recovery.isTeleActive, pysd_main.blackBox.wakeUp, pysd_main.blackBox.batteryVoltage, pysd_main.payload.wakenUp, pysd_main.payload.isRecording, pysd_main.payload.data, pysd_main.payload.vBat, pysd_main.payload.isRpiOn, pysd_main.options.lora_freq_khz, pysd_main.options.countdown_begin_time, pysd_main.options.ignition_time, pysd_main.options.tank_min_pressure, pysd_main.options.flash_write, pysd_main.options.force_launch, pysd_main.options.data_current_period, pysd_main.options.lora_current_period, pysd_main.options.flash_write_current_period, pysd_main.options.sd_write_current_period, pysd_main.errors.sd, pysd_main.errors.flash, pysd_main.errors.rtos, pysd_main.errors.espnow, pysd_main.errors.watchdog, pysd_main.errors.sensors, pysd_main.errors.exceptions, pysd_main.errors.recovery);
    }

    return frame_size;
}